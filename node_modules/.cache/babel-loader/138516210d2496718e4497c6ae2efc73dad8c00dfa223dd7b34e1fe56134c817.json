{"ast":null,"code":"var _jsxFileName = \"/mnt/disk500/yolotest2/src/components/CameraCapture.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport Webcam from 'react-webcam';\n\n/**\n * Camera capture component with Windows 98 styling\n * \n * @param {Object} props - Component props\n * @param {Function} props.onCapture - Callback when photo is captured\n * @param {Function} props.onCancel - Callback when capture is cancelled\n * @param {number} props.width - Camera container width\n * @param {number} props.height - Camera container height\n */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CameraCapture = ({\n  onCapture,\n  onCancel,\n  width = 640,\n  height = 480\n}) => {\n  _s();\n  const webcamRef = useRef(null);\n  const [capturedImage, setCapturedImage] = useState(null);\n  const [error, setError] = useState(null);\n  const [cameraPermission, setCameraPermission] = useState('pending'); // 'pending', 'granted', 'denied'\n\n  // Handle camera errors\n  useEffect(() => {\n    const checkPermissions = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: true\n        });\n        stream.getTracks().forEach(track => track.stop());\n        setCameraPermission('granted');\n      } catch (err) {\n        console.error('Camera permission error:', err);\n        setCameraPermission('denied');\n        setError('無法啟動相機，請確認您已授予相機存取權限。');\n      }\n    };\n    checkPermissions();\n  }, []);\n\n  // Capture photo\n  const captureImage = () => {\n    if (webcamRef.current) {\n      const imageSrc = webcamRef.current.getScreenshot();\n      setCapturedImage(imageSrc);\n    }\n  };\n\n  // Confirm captured image\n  const confirmImage = () => {\n    if (capturedImage && onCapture) {\n      onCapture(capturedImage);\n    }\n  };\n\n  // Retake photo\n  const retakeImage = () => {\n    setCapturedImage(null);\n  };\n\n  // Cancel capture\n  const handleCancel = () => {\n    if (onCancel) {\n      onCancel();\n    }\n  };\n\n  // Retry camera permission\n  const retryCamera = () => {\n    setCameraPermission('pending');\n    setError(null);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"camera-capture\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"camera-container window\",\n      style: {\n        width: `${width}px`,\n        height: `${height}px`,\n        overflow: 'hidden'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"title-bar\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"title-bar-text\",\n          children: \"\\u76F8\\u6A5F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"window-body\",\n        style: {\n          padding: 0,\n          height: 'calc(100% - 28px)',\n          background: '#000'\n        },\n        children: [!capturedImage && cameraPermission === 'granted' && /*#__PURE__*/_jsxDEV(Webcam, {\n          audio: false,\n          ref: webcamRef,\n          screenshotFormat: \"image/jpeg\",\n          videoConstraints: {\n            width: width,\n            height: height - 28,\n            facingMode: \"user\"\n          },\n          style: {\n            width: '100%',\n            height: '100%',\n            objectFit: 'cover'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this), capturedImage && /*#__PURE__*/_jsxDEV(\"img\", {\n          src: capturedImage,\n          alt: \"\\u5DF2\\u62CD\\u651D\\u7684\\u7167\\u7247\",\n          style: {\n            width: '100%',\n            height: '100%',\n            objectFit: 'contain'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '20px',\n            textAlign: 'center',\n            color: 'white',\n            height: '100%',\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'center',\n            alignItems: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: retryCamera,\n            children: \"\\u91CD\\u8A66\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"camera-controls\",\n      children: [!capturedImage && cameraPermission === 'granted' && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: captureImage,\n          children: \"\\u62CD\\u7167\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCancel,\n          children: \"\\u53D6\\u6D88\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), capturedImage && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: confirmImage,\n          children: \"\\u4F7F\\u7528\\u6B64\\u7167\\u7247\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: retakeImage,\n          children: \"\\u91CD\\u65B0\\u62CD\\u651D\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCancel,\n          children: \"\\u53D6\\u6D88\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n};\n_s(CameraCapture, \"QxzVRcTJpqQDJizjqEH4sz76D8Q=\");\n_c = CameraCapture;\nexport default CameraCapture;\nvar _c;\n$RefreshReg$(_c, \"CameraCapture\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Webcam","jsxDEV","_jsxDEV","Fragment","_Fragment","CameraCapture","onCapture","onCancel","width","height","_s","webcamRef","capturedImage","setCapturedImage","error","setError","cameraPermission","setCameraPermission","checkPermissions","stream","navigator","mediaDevices","getUserMedia","video","getTracks","forEach","track","stop","err","console","captureImage","current","imageSrc","getScreenshot","confirmImage","retakeImage","handleCancel","retryCamera","className","children","style","overflow","fileName","_jsxFileName","lineNumber","columnNumber","padding","background","audio","ref","screenshotFormat","videoConstraints","facingMode","objectFit","src","alt","textAlign","color","display","flexDirection","justifyContent","alignItems","onClick","_c","$RefreshReg$"],"sources":["/mnt/disk500/yolotest2/src/components/CameraCapture.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport Webcam from 'react-webcam';\n\n/**\n * Camera capture component with Windows 98 styling\n * \n * @param {Object} props - Component props\n * @param {Function} props.onCapture - Callback when photo is captured\n * @param {Function} props.onCancel - Callback when capture is cancelled\n * @param {number} props.width - Camera container width\n * @param {number} props.height - Camera container height\n */\nconst CameraCapture = ({\n  onCapture,\n  onCancel,\n  width = 640,\n  height = 480\n}) => {\n  const webcamRef = useRef(null);\n  const [capturedImage, setCapturedImage] = useState(null);\n  const [error, setError] = useState(null);\n  const [cameraPermission, setCameraPermission] = useState('pending'); // 'pending', 'granted', 'denied'\n\n  // Handle camera errors\n  useEffect(() => {\n    const checkPermissions = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n        stream.getTracks().forEach(track => track.stop());\n        setCameraPermission('granted');\n      } catch (err) {\n        console.error('Camera permission error:', err);\n        setCameraPermission('denied');\n        setError('無法啟動相機，請確認您已授予相機存取權限。');\n      }\n    };\n\n    checkPermissions();\n  }, []);\n\n  // Capture photo\n  const captureImage = () => {\n    if (webcamRef.current) {\n      const imageSrc = webcamRef.current.getScreenshot();\n      setCapturedImage(imageSrc);\n    }\n  };\n\n  // Confirm captured image\n  const confirmImage = () => {\n    if (capturedImage && onCapture) {\n      onCapture(capturedImage);\n    }\n  };\n\n  // Retake photo\n  const retakeImage = () => {\n    setCapturedImage(null);\n  };\n\n  // Cancel capture\n  const handleCancel = () => {\n    if (onCancel) {\n      onCancel();\n    }\n  };\n\n  // Retry camera permission\n  const retryCamera = () => {\n    setCameraPermission('pending');\n    setError(null);\n  };\n\n  return (\n    <div className=\"camera-capture\">\n      <div \n        className=\"camera-container window\"\n        style={{ width: `${width}px`, height: `${height}px`, overflow: 'hidden' }}\n      >\n        <div className=\"title-bar\">\n          <div className=\"title-bar-text\">相機</div>\n        </div>\n        <div className=\"window-body\" style={{ padding: 0, height: 'calc(100% - 28px)', background: '#000' }}>\n          {/* Camera preview */}\n          {!capturedImage && cameraPermission === 'granted' && (\n            <Webcam\n              audio={false}\n              ref={webcamRef}\n              screenshotFormat=\"image/jpeg\"\n              videoConstraints={{\n                width: width,\n                height: height - 28,\n                facingMode: \"user\"\n              }}\n              style={{ width: '100%', height: '100%', objectFit: 'cover' }}\n            />\n          )}\n          \n          {/* Captured photo */}\n          {capturedImage && (\n            <img \n              src={capturedImage} \n              alt=\"已拍攝的照片\" \n              style={{ width: '100%', height: '100%', objectFit: 'contain' }} \n            />\n          )}\n          \n          {/* Error message */}\n          {error && (\n            <div style={{ padding: '20px', textAlign: 'center', color: 'white', height: '100%', display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center' }}>\n              <p>{error}</p>\n              <button onClick={retryCamera}>重試</button>\n            </div>\n          )}\n        </div>\n      </div>\n      \n      {/* Controls */}\n      <div className=\"camera-controls\">\n        {!capturedImage && cameraPermission === 'granted' && (\n          <>\n            <button onClick={captureImage}>拍照</button>\n            <button onClick={handleCancel}>取消</button>\n          </>\n        )}\n        \n        {capturedImage && (\n          <>\n            <button onClick={confirmImage}>使用此照片</button>\n            <button onClick={retakeImage}>重新拍攝</button>\n            <button onClick={handleCancel}>取消</button>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default CameraCapture;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}